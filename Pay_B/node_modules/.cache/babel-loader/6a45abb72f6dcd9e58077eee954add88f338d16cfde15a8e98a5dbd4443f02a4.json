{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  data() {\n    return {\n      tableData: [],\n      form: {\n        userId: undefined,\n        orderId: undefined,\n        recordNum: 0,\n        fund: 0.00,\n        refund: 0.00\n      },\n      formLabelWidth: '100px',\n      time: \"\"\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      let date = new Date();\n      let year = date.getFullYear();\n      let month = date.getMonth() + 1;\n      let day = date.getDate();\n      this.time = year + '-' + month + '-' + day;\n      let url = 'http://localhost/recon/api/reconlist?date=' + this.time;\n      axios.get(url).then(res => {\n        this.tableData = res.data;\n        this.updateData();\n      });\n    },\n    /**\r\n     * 表格排序事件处理函数\r\n     * @param {object} {column,prop,order} 列数据|排序字段|排序方式\r\n     */\n    onSortChange({\n      prop,\n      order\n    }) {\n      this.tableData.sort(this.compare(prop, order));\n    },\n    /**\r\n     * 排序比较\r\n     * @param {string} propertyName 排序的属性名\r\n     * @param {string} sort ascending(升序)/descending(降序)\r\n     * @return {function}\r\n     */\n    compare(propertyName, sort) {\n      return function (obj1, obj2) {\n        var value1 = obj1[propertyName];\n        var value2 = obj2[propertyName];\n        if (typeof value1 === 'string' && typeof value2 === 'string') {\n          const res = value1.localeCompare(value2, 'zh');\n          return sort === 'ascending' ? res : -res;\n        } else {\n          if (value1 <= value2) {\n            return sort === 'ascending' ? -1 : 1;\n          } else if (value1 > value2) {\n            return sort === 'ascending' ? 1 : -1;\n          }\n        }\n      };\n    },\n    select() {\n      // this.loading  = true;\n      if (null == this.time) {}\n      if (0 !== this.time.length) {\n        axios.get('http://localhost/recon/api/reconlist?date=' + this.time).then(res => {\n          if (this.form.userId == undefined && this.form.orderId == undefined) {\n            this.tableData = res.data;\n            this.updateData();\n          } else if (this.form.orderId == undefined) {\n            for (var a in res.data) {\n              if (res.data[a][\"userId\"] != this.form.userId) delete res.data[a];\n              this.tableData = res.data;\n              this.updateData();\n            }\n          } else if (this.form.userId == undefined) {\n            for (var a in res.data) {\n              if (res.data[a][\"orderId\"] != this.form.orderId) delete res.data[a];\n              this.tableData = res.data;\n              this.updateData();\n            }\n          } else {\n            for (var a in res.data) {\n              if (res.data[a][\"orderId\"] != this.form.orderId || res.data[a][\"userId\"] != this.form.userId) delete res.data[a];\n              this.tableData = res.data;\n              this.updateData();\n            }\n          }\n        }).catch(error => {\n          console.log(error);\n          alert('输入格式错误');\n        });\n      }\n    },\n    handleCommand(command) {\n      axios.get('http://localhost/recon/api/reconlist?date=' + this.time).then(res => {\n        for (var a in res.data) {\n          if (command * res.data[a][\"amount\"] < 0) {\n            delete res.data[a];\n          }\n        }\n        ;\n        this.tableData = res.data;\n        this.updateData();\n      }).catch(error => {\n        console.log(error);\n        alert('输入格式错误');\n      });\n    },\n    updateData() {\n      this.form.fund = 0;\n      this.form.refund = 0;\n      this.form.recordNum = 0;\n      for (var a in this.tableData) {\n        this.form.recordNum++;\n        if (this.tableData[a].amount > 0) this.form.refund += this.tableData[a].amount;else this.form.fund -= this.tableData[a].amount;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","tableData","form","userId","undefined","orderId","recordNum","fund","refund","formLabelWidth","time","created","load","methods","date","Date","year","getFullYear","month","getMonth","day","getDate","url","get","then","res","updateData","onSortChange","prop","order","sort","compare","propertyName","obj1","obj2","value1","value2","localeCompare","select","length","a","catch","error","console","log","alert","handleCommand","command","amount"],"sources":["src/views/recon_views/ReconView.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div class=\"search\" style=\"margin-left: 10px\">\r\n            <el-dropdown @command=\"handleCommand\">\r\n              <el-button type=\"primary\">查询订单类型\r\n                  <i class=\"el-icon-arrow-down el-icon--right\"></i></el-button>\r\n                <el-dropdown-menu slot=\"dropdown\">\r\n                    <el-dropdown-item command=\"0\">全部</el-dropdown-item>\r\n                    <el-dropdown-item command=\"-1\">付款</el-dropdown-item>\r\n                    <el-dropdown-item command=\"1\">退款</el-dropdown-item>\r\n                </el-dropdown-menu>\r\n            </el-dropdown>\r\n            <el-date-picker @change=\"select()\"\r\n                v-model=\"time\"\r\n                type=\"date\"\r\n                placeholder=\"选择日期\"\r\n                style=\"margin-left: 20px\"\r\n                value-format=\"yyyy-MM-dd\">\r\n            </el-date-picker>\r\n            <label style=\"margin: 15px\">用户id:</label>\r\n            <el-input-number :controls=\"false\"\r\n            v-model=\"form.userId\"\r\n            :min=\"0\"\r\n            :precision=\"0\" style=\"paddle:1px\"\r\n          ></el-input-number>\r\n            <label style=\"margin: 15px\">订单id:</label>\r\n            <el-input-number :controls=\"false\"\r\n            v-model=\"form.orderId\"\r\n            :min=\"0\"\r\n            :precision=\"0\" style=\"paddle:1px\"\r\n          ></el-input-number>\r\n            <el-button type=\"small\" style=\"margin-left: 15px\" @click=\"select()\">查询</el-button>\r\n        </div>\r\n        <el-table\r\n            class=\"recon\"\r\n            :data=\"tableData\"\r\n            stripe\r\n            style=\"width: 100%; margin: 0 auto 0 50px;\"\r\n            height=\"600\"\r\n            @change=\"reCount\"\r\n            @sort-change=\"onSortChange\">\r\n            <el-table-column\r\n                label=\"事务id\"\r\n                prop=\"transactionId\"\r\n                width=\"150%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                label=\"用户id\"\r\n                prop=\"userId\"\r\n                width=\"150%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                label=\"卖方id\"\r\n                prop=\"sellerId\"\r\n                width=\"150%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                label=\"订单id\"\r\n                prop=\"orderId\"\r\n                width=\"150%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                label=\"余额变动\"\r\n                prop=\"amount\"\r\n                width=\"150%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n            <el-table-column\r\n                label=\"时间\"\r\n                prop=\"time\"\r\n                width=\"200%\"\r\n                sortable=\"custom\"\r\n                :sort-orders=\"['ascending','descending']\">\r\n            </el-table-column>\r\n        </el-table>\r\n        <br>\r\n        <label style=\"margin-top:20px;margin-left: 350px;\">条目数: {{form.recordNum}}</label>\r\n        <label style=\"margin-left: 50px;\">付款总额: {{form.fund}}</label>\r\n        <label style=\"margin-left: 50px;\">退款总额: {{form.refund}}</label>\r\n    </div>\r\n</template>\r\n\r\n<style>\r\n.demo-table-expand {\r\n    font-size: 0;\r\n}\r\n.demo-table-expand label {\r\n    width: 90px;\r\n    color: #99a9bf;\r\n}\r\n.demo-table-expand .el-form-item {\r\n    margin-right: 0;\r\n    margin-bottom: 0;\r\n    width: 50%;\r\n}\r\n.el-input-number__{\r\n    margin: 0 !important;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            tableData: [],\r\n            form: {\r\n                userId: undefined,\r\n                orderId: undefined,\r\n                recordNum: 0,\r\n                fund: 0.00,\r\n                refund: 0.00,\r\n            },\r\n            formLabelWidth: '100px',\r\n            time: \"\",\r\n        }\r\n    },\r\n    created() {\r\n        this.load()\r\n    },\r\n    methods: {\r\n        load() {\r\n            let date = new Date();\r\n            let year = date.getFullYear();\r\n            let month = date.getMonth()+1;\r\n            let day = date.getDate();\r\n            this.time = year + '-' + month + '-' + day;\r\n            let url = 'http://localhost/recon/api/reconlist?date=' + this.time;\r\n            axios.get(url).then(res => {\r\n                this.tableData = res.data;\r\n                this.updateData();\r\n            })\r\n        },\r\n        /**\r\n         * 表格排序事件处理函数\r\n         * @param {object} {column,prop,order} 列数据|排序字段|排序方式\r\n         */\r\n        onSortChange({prop, order}) {\r\n            this.tableData.sort(this.compare(prop, order));\r\n        },\r\n\r\n        /**\r\n         * 排序比较\r\n         * @param {string} propertyName 排序的属性名\r\n         * @param {string} sort ascending(升序)/descending(降序)\r\n         * @return {function}\r\n         */\r\n        compare(propertyName, sort) {\r\n            return function (obj1, obj2) {\r\n                var value1 = obj1[propertyName]\r\n                var value2 = obj2[propertyName]\r\n                if (typeof value1 === 'string' && typeof value2 === 'string') {\r\n                    const res = value1.localeCompare(value2, 'zh')\r\n                    return sort === 'ascending' ? res : -res\r\n                } else {\r\n                    if (value1 <= value2) {\r\n                        return sort === 'ascending' ? -1 : 1\r\n                    } else if (value1 > value2) {\r\n                        return sort === 'ascending' ? 1 : -1\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        select() {\r\n            // this.loading  = true;\r\n            if (null == this.time) {\r\n            }\r\n            if (0 !== this.time.length) {\r\n                axios.get('http://localhost/recon/api/reconlist?date='+ this.time)\r\n                    .then((res) => {\r\n                        if(this.form.userId == undefined && this.form.orderId == undefined){\r\n                                this.tableData = res.data;\r\n                                this.updateData();\r\n                            }\r\n                        else if(this.form.orderId == undefined){\r\n                            for (var a in res.data) {\r\n                            if(res.data[a][\"userId\"] != this.form.userId)\r\n                                delete res.data[a];\r\n                            this.tableData = res.data;\r\n                            this.updateData();\r\n                        }\r\n                        }\r\n                        else if(this.form.userId == undefined){\r\n                            for (var a in res.data) {\r\n                            if(res.data[a][\"orderId\"] != this.form.orderId)\r\n                                delete res.data[a];\r\n                            this.tableData = res.data;\r\n                            this.updateData();\r\n                        }\r\n                        }\r\n                        else {\r\n                            for (var a in res.data) {\r\n                            if(res.data[a][\"orderId\"] != this.form.orderId || res.data[a][\"userId\"] != this.form.userId)\r\n                                delete res.data[a];\r\n                            this.tableData = res.data;\r\n                            this.updateData();\r\n                        }\r\n                        }\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error);\r\n                        alert('输入格式错误');\r\n                    });\r\n            }\r\n        },\r\n        handleCommand(command) {\r\n            axios.get('http://localhost/recon/api/reconlist?date='+ this.time)\r\n                    .then((res) => {\r\n                        for (var a in res.data) {\r\n                            if(command * res.data[a][\"amount\"] < 0)\r\n                            {\r\n                                delete res.data[a];\r\n                            }\r\n                        };\r\n                        this.tableData = res.data;\r\n                        this.updateData();\r\n                    })\r\n                    .catch((error) => {\r\n                        console.log(error);\r\n                        alert('输入格式错误');\r\n                    });\r\n        },\r\n        updateData() {\r\n            this.form.fund = 0;\r\n            this.form.refund = 0;\r\n            this.form.recordNum = 0;\r\n                for(var a in this.tableData) {\r\n                    this.form.recordNum++;\r\n                    if(this.tableData[a].amount > 0) this.form.refund += this.tableData[a].amount;\r\n                    else this.form.fund -= this.tableData[a].amount; \r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n</script>"],"mappings":"AA8GA,OAAAA,KAAA;AACA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,IAAA;QACAC,MAAA,EAAAC,SAAA;QACAC,OAAA,EAAAD,SAAA;QACAE,SAAA;QACAC,IAAA;QACAC,MAAA;MACA;MACAC,cAAA;MACAC,IAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACAD,KAAA;MACA,IAAAE,IAAA,OAAAC,IAAA;MACA,IAAAC,IAAA,GAAAF,IAAA,CAAAG,WAAA;MACA,IAAAC,KAAA,GAAAJ,IAAA,CAAAK,QAAA;MACA,IAAAC,GAAA,GAAAN,IAAA,CAAAO,OAAA;MACA,KAAAX,IAAA,GAAAM,IAAA,SAAAE,KAAA,SAAAE,GAAA;MACA,IAAAE,GAAA,uDAAAZ,IAAA;MACAX,KAAA,CAAAwB,GAAA,CAAAD,GAAA,EAAAE,IAAA,CAAAC,GAAA;QACA,KAAAxB,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;QACA,KAAA0B,UAAA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC,aAAA;MAAAC,IAAA;MAAAC;IAAA;MACA,KAAA5B,SAAA,CAAA6B,IAAA,MAAAC,OAAA,CAAAH,IAAA,EAAAC,KAAA;IACA;IAEA;AACA;AACA;AACA;AACA;AACA;IACAE,QAAAC,YAAA,EAAAF,IAAA;MACA,iBAAAG,IAAA,EAAAC,IAAA;QACA,IAAAC,MAAA,GAAAF,IAAA,CAAAD,YAAA;QACA,IAAAI,MAAA,GAAAF,IAAA,CAAAF,YAAA;QACA,WAAAG,MAAA,wBAAAC,MAAA;UACA,MAAAX,GAAA,GAAAU,MAAA,CAAAE,aAAA,CAAAD,MAAA;UACA,OAAAN,IAAA,mBAAAL,GAAA,IAAAA,GAAA;QACA;UACA,IAAAU,MAAA,IAAAC,MAAA;YACA,OAAAN,IAAA;UACA,WAAAK,MAAA,GAAAC,MAAA;YACA,OAAAN,IAAA;UACA;QACA;MACA;IACA;IACAQ,OAAA;MACA;MACA,iBAAA5B,IAAA,GACA;MACA,eAAAA,IAAA,CAAA6B,MAAA;QACAxC,KAAA,CAAAwB,GAAA,qDAAAb,IAAA,EACAc,IAAA,CAAAC,GAAA;UACA,SAAAvB,IAAA,CAAAC,MAAA,IAAAC,SAAA,SAAAF,IAAA,CAAAG,OAAA,IAAAD,SAAA;YACA,KAAAH,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;YACA,KAAA0B,UAAA;UACA,OACA,SAAAxB,IAAA,CAAAG,OAAA,IAAAD,SAAA;YACA,SAAAoC,CAAA,IAAAf,GAAA,CAAAzB,IAAA;cACA,IAAAyB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA,oBAAAtC,IAAA,CAAAC,MAAA,EACA,OAAAsB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA;cACA,KAAAvC,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;cACA,KAAA0B,UAAA;YACA;UACA,OACA,SAAAxB,IAAA,CAAAC,MAAA,IAAAC,SAAA;YACA,SAAAoC,CAAA,IAAAf,GAAA,CAAAzB,IAAA;cACA,IAAAyB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA,qBAAAtC,IAAA,CAAAG,OAAA,EACA,OAAAoB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA;cACA,KAAAvC,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;cACA,KAAA0B,UAAA;YACA;UACA,OACA;YACA,SAAAc,CAAA,IAAAf,GAAA,CAAAzB,IAAA;cACA,IAAAyB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA,qBAAAtC,IAAA,CAAAG,OAAA,IAAAoB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA,oBAAAtC,IAAA,CAAAC,MAAA,EACA,OAAAsB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA;cACA,KAAAvC,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;cACA,KAAA0B,UAAA;YACA;UACA;QACA,GACAe,KAAA,CAAAC,KAAA;UACAC,OAAA,CAAAC,GAAA,CAAAF,KAAA;UACAG,KAAA;QACA;MACA;IACA;IACAC,cAAAC,OAAA;MACAhD,KAAA,CAAAwB,GAAA,qDAAAb,IAAA,EACAc,IAAA,CAAAC,GAAA;QACA,SAAAe,CAAA,IAAAf,GAAA,CAAAzB,IAAA;UACA,IAAA+C,OAAA,GAAAtB,GAAA,CAAAzB,IAAA,CAAAwC,CAAA,iBACA;YACA,OAAAf,GAAA,CAAAzB,IAAA,CAAAwC,CAAA;UACA;QACA;QAAA;QACA,KAAAvC,SAAA,GAAAwB,GAAA,CAAAzB,IAAA;QACA,KAAA0B,UAAA;MACA,GACAe,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,KAAA;QACAG,KAAA;MACA;IACA;IACAnB,WAAA;MACA,KAAAxB,IAAA,CAAAK,IAAA;MACA,KAAAL,IAAA,CAAAM,MAAA;MACA,KAAAN,IAAA,CAAAI,SAAA;MACA,SAAAkC,CAAA,SAAAvC,SAAA;QACA,KAAAC,IAAA,CAAAI,SAAA;QACA,SAAAL,SAAA,CAAAuC,CAAA,EAAAQ,MAAA,WAAA9C,IAAA,CAAAM,MAAA,SAAAP,SAAA,CAAAuC,CAAA,EAAAQ,MAAA,MACA,KAAA9C,IAAA,CAAAK,IAAA,SAAAN,SAAA,CAAAuC,CAAA,EAAAQ,MAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}