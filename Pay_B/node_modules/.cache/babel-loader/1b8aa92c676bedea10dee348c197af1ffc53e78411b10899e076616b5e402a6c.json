{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport md5 from 'js-md5';\nimport IconView from \"@/components/Icon.vue\";\nimport SideBar from \"@/components/SideBar.vue\";\nimport router from \"@/router\";\nexport default {\n  components: {\n    SideBar,\n    IconView\n  },\n  item: [\"name\", \"price\", \"itemId\", \"sellerId\", \"itemDescription\", \"count\", \"image\"],\n  data() {\n    return {\n      allItems: [],\n      itemData: [],\n      search_name: \"\",\n      search_price1: '',\n      search_price2: '',\n      detailVisible: false,\n      pwdDialog: false,\n      direction: 'btt',\n      num: 1,\n      pwd: '',\n      detailData: {\n        item: []\n      },\n      isLogoutModalVisible: false,\n      isModalVisible: false\n    };\n  },\n  mounted() {\n    axios.get('http://localhost/order/type').then(res => {\n      if (String(res.data.code) === '0') {\n        this.$notify.error({\n          title: '错误',\n          message: \"非法访问！\"\n        });\n        this.logout();\n      } else {\n        this.type = res.data.type;\n        if (this.type !== \"0\") {\n          this.$notify.error({\n            title: '错误',\n            message: \"非法访问！\"\n          });\n          this.logout();\n        }\n      }\n    });\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      axios.get('http://localhost/item').then(res => {\n        console.log(res.data);\n        if (String(res.data.code) === '0') {\n          this.$notify.error({\n            title: '错误',\n            message: res.data.msg\n          });\n        } else {\n          this.allItems = res.data.data;\n          this.itemData = res.data.data;\n        }\n      });\n    },\n    getImage(image) {\n      return `http://localhost${image}`;\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    handleChange(value) {\n      console.log(value);\n    },\n    buy() {\n      const order = {\n        sellerId: this.detailData.item.sellerId,\n        itemId: this.detailData.item.itemId,\n        totalPrice: this.detailData.item.price,\n        orderStateString: 0,\n        complaintRecord: this.detailData.item.itemDescription\n      };\n      console.log(order);\n      axios.post('http://localhost/item/' + md5(this.pwd), order).then(res => {\n        console.log(res);\n        if (String(res.data.code) === '1') {\n          this.$notify({\n            title: '成功',\n            message: res.data.msg,\n            type: 'success'\n          });\n          this.load();\n        } else {\n          this.$notify.error({\n            title: '错误',\n            message: res.data.msg\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n        alert('输入格式错误');\n      });\n    },\n    detail(item) {\n      this.detailData.item = item;\n    },\n    logout() {\n      var url = \"http://localhost/user/logout\";\n      fetch(url, {\n        method: 'GET',\n        credentials: 'include'\n      }).then(response => response.json()).then(json_data => {\n        // 处理响应数据\n        console.log(json_data);\n        if (json_data.code == \"1\") {\n          window.sessionStorage.setItem('needRefresh', 'true');\n          this.$router.push(\"/LoginView\");\n        } else {\n          alert(\"登出失败\");\n        }\n      }).catch(error => {\n        // 处理错误\n        console.error(error);\n        alert(\"登出失败\");\n      });\n    },\n    logout_account() {\n      this.isLogoutModalVisible = true;\n    },\n    handleSearch() {\n      // 商品名筛选\n      this.itemData = this.allItems.filter(item => {\n        if (this.search_name === \"\") {\n          return item;\n        } else {\n          if (Number(item.name.indexOf(this.search_name)) >= 0) {\n            return item;\n          }\n        }\n      });\n      // 价格筛选\n      this.itemData = this.itemData.filter(item => {\n        if (this.search_price1 === \"\" && this.search_price2 === \"\") {\n          return item;\n        } else if (this.search_price1 !== \"\" && this.search_price2 !== \"\" && item.price >= this.search_price1 && item.price <= this.search_price2) {\n          return item;\n        } else if (this.search_price1 === \"\" && item.price <= this.search_price2) {\n          return item;\n        } else if (this.search_price2 === \"\" && item.price >= this.search_price1) {\n          return item;\n        }\n      });\n    },\n    reset() {\n      this.search_name = \"\";\n      this.search_price1 = \"\";\n      this.search_price2 = \"\";\n      this.itemData = this.allItems;\n    }\n  }\n};","map":{"version":3,"names":["axios","md5","IconView","SideBar","router","components","item","data","allItems","itemData","search_name","search_price1","search_price2","detailVisible","pwdDialog","direction","num","pwd","detailData","isLogoutModalVisible","isModalVisible","mounted","get","then","res","String","code","$notify","error","title","message","logout","type","created","load","methods","console","log","msg","getImage","image","handleClose","done","$confirm","_","catch","handleChange","value","buy","order","sellerId","itemId","totalPrice","price","orderStateString","complaintRecord","itemDescription","post","alert","detail","url","fetch","method","credentials","response","json","json_data","window","sessionStorage","setItem","$router","push","logout_account","handleSearch","filter","Number","name","indexOf","reset"],"sources":["src/views/BuyerView.vue"],"sourcesContent":["<template>\r\n    <!DOCTYPE html>\r\n    <html>\r\n\r\n    <head>\r\n        <title>在线支付系统</title>\r\n\r\n    </head>\r\n\r\n    <body>\r\n    <IconView></IconView>\r\n    <header style=\"height:30px;background:#1e6aba;color:white\">\r\n        <h1>在线支付系统</h1>\r\n        <button class=\"button\"\r\n                style=\"border:none; cursor: pointer; color: black; position: absolute; top: 30px; right: 30px; background-color: #1e6aba; font-size: 16px;\"\r\n                @click=\"logout_account\">退出系统</button>\r\n\r\n    </header>\r\n    <el-container>\r\n        <el-aside><SideBar></SideBar></el-aside>\r\n        <el-main>\r\n        <div>\r\n            <div class=\"search\" style=\"margin-left:2%;margin-bottom: 3%\">\r\n                <el-main></el-main>\r\n                <el-input\r\n                    placeholder=\"商品名\"\r\n                    prefix-icon=\"el-icon-search\"\r\n                    v-model=\"search_name\"\r\n                    style=\"width: 500px; margin-left: 5%; margin-bottom: 10px\"\r\n                    clearable>\r\n                </el-input>\r\n                <el-input\r\n                    placeholder=\"价格下界\"\r\n                    prefix-icon=\"el-icon-search\"\r\n                    v-model=\"search_price1\"\r\n                    style=\"width: 150px; margin-left: 10px; margin-bottom: 10px\"\r\n                    clearable>\r\n                </el-input>\r\n                -\r\n                <el-input\r\n                    placeholder=\"价格上界\"\r\n                    prefix-icon=\"el-icon-search\"\r\n                    v-model=\"search_price2\"\r\n                    style=\"width: 150px; margin-right: 10px; margin-bottom: 10px\"\r\n                    clearable>\r\n                </el-input>\r\n                <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleSearch\">搜索</el-button>\r\n                <el-button type=\"primary\" icon=\"el-icon-circle-close\" @click=\"reset\">重置</el-button>\r\n            </div>\r\n            <el-col style=\"width: 25%; margin-left: 5%; margin-bottom: 5%\" v-for=\"item in itemData\" :key=\"item.itemId\" :offset=\"1\">\r\n                <el-card shadow=\"hover\" :body-style=\"{ padding: '1%' }\">\r\n                    <el-image :src=\"getImage(item.image)\"  class=\"image\"/>\r\n                    <div style=\"padding: 14px;\">\r\n                        <span>{{ item.name }}</span>\r\n                        <div class=\"bottom clearfix\">\r\n                            ￥{{ item.price }}\r\n                            <el-button type=\"text\" class=\"button\" @click=\"detailVisible = true, detail(item)\" style=\"margin-left: 5%\">详细信息</el-button>\r\n                            <el-button @click=\"pwd = '', pwdDialog = true, detail(item)\" type=\"text\" class=\"button\" style=\"margin-left: 6%;\">\r\n                                购买\r\n                            </el-button>\r\n                            <el-dialog\r\n                                title=\"请输入密码\"\r\n                                :visible.sync=\"pwdDialog\"\r\n                                width=\"30%\"\r\n                                :before-close=\"handleClose\">\r\n                                <el-input placeholder=\"请输入密码\" v-model=\"pwd\" show-password></el-input>\r\n                                <span slot=\"footer\" class=\"dialog-footer\">\r\n                                    <el-button @click=\"pwdDialog = false\">取 消</el-button>\r\n                                    <el-button type=\"primary\" @click=\"pwdDialog = false, buy()\">确 定</el-button>\r\n                                </span>\r\n                            </el-dialog>\r\n                        </div>\r\n                        <el-dialog title=\"商品信息\" :visible.sync=\"detailVisible\">\r\n                            <el-descriptions>\r\n                                <el-descriptions-item label=\"商品名\">{{ detailData.item.name }}</el-descriptions-item>\r\n                                <el-descriptions-item label=\"价格\">{{ detailData.item.price }}</el-descriptions-item>\r\n                                <el-descriptions-item label=\"商家\">{{ detailData.item.sellerId }}</el-descriptions-item>\r\n                                <el-descriptions-item label=\"库存\">{{ detailData.item.count }}</el-descriptions-item>\r\n                                <el-descriptions-item label=\"详细信息\">{{ detailData.item.itemDescription }}</el-descriptions-item>\r\n                            </el-descriptions>\r\n                        </el-dialog>\r\n                    </div>\r\n                </el-card>\r\n            </el-col>\r\n        </div>\r\n        <div class=\"overlay\" :class=\"{ 'show-overlay': isModalVisible }\"></div>\r\n\r\n\r\n        <div class=\"modal\" :class=\"{ 'show-modal': isLogoutModalVisible }\" style=\"width: 250px; height: 180px;\">\r\n            <!-- 弹框内容 -->\r\n            <h3 class=\"title\">是否退出系统</h3>\r\n            <div style=\"display:flex; justify-content: center; align-items: center; width:98%;\">\r\n                <button style=\"cursor: pointer;\" @click=\"logout\">确认</button>\r\n                <button style=\"cursor: pointer; margin-left: 10px;\" @click=\"isLogoutModalVisible=false\">取消</button>\r\n            </div>\r\n        </div>\r\n        </el-main>\r\n    </el-container>\r\n    </body>\r\n    </html>\r\n</template>\r\n\r\n<style>\r\n.demo-table-expand {\r\n    font-size: 0;\r\n}\r\n.demo-table-expand label {\r\n    width: 90px;\r\n    color: #99a9bf;\r\n}\r\n.demo-table-expand .el-form-item {\r\n    margin-right: 0;\r\n    margin-bottom: 0;\r\n    width: 50%;\r\n}\r\n\r\n.bottom {\r\n    margin-top: 13px;\r\n    line-height: 12px;\r\n}\r\n.button {\r\n    padding: 0;\r\n    float: right;\r\n}\r\n.clearfix:before,\r\n.clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n}\r\n.clearfix:after {\r\n    clear: both\r\n}\r\n.image {\r\n    height: 400px;\r\n    object-fit: contain;\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n.white {\r\n    background: #ffffff;\r\n    border-radius: 4px;\r\n    min-height: 36px;\r\n}\r\n</style>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport md5 from 'js-md5';\r\nimport IconView from \"@/components/Icon.vue\";\r\nimport SideBar from \"@/components/SideBar.vue\";\r\nimport router from \"@/router\";\r\n\r\nexport default {\r\n    components: {SideBar, IconView},\r\n    item: [\"name\", \"price\", \"itemId\", \"sellerId\", \"itemDescription\", \"count\", \"image\"],\r\n    data(){\r\n        return {\r\n            allItems: [],\r\n            itemData: [],\r\n            search_name:\"\",\r\n            search_price1:'',\r\n            search_price2:'',\r\n            detailVisible: false,\r\n            pwdDialog: false,\r\n            direction: 'btt',\r\n            num: 1,\r\n            pwd: '',\r\n            detailData : {\r\n                item:[],\r\n            },\r\n            isLogoutModalVisible: false,\r\n            isModalVisible: false,\r\n        }\r\n    },\r\n    mounted() {\r\n        axios.get('http://localhost/order/type').then(res => {\r\n            if (String(res.data.code) === '0') {\r\n                this.$notify.error({\r\n                    title: '错误',\r\n                    message: \"非法访问！\"\r\n                });\r\n                this.logout();\r\n            } else {\r\n                this.type = res.data.type;\r\n                if(this.type !== \"0\"){\r\n                    this.$notify.error({\r\n                        title: '错误',\r\n                        message: \"非法访问！\"\r\n                    });\r\n                    this.logout();\r\n                }\r\n            }\r\n        })\r\n    },\r\n    created() {\r\n        this.load()\r\n    },\r\n    methods:{\r\n        load(){\r\n            axios.get('http://localhost/item').then(res=>{\r\n                console.log(res.data);\r\n                if(String(res.data.code) === '0') {\r\n                    this.$notify.error({\r\n                        title: '错误',\r\n                        message: res.data.msg\r\n                    });\r\n                }else{\r\n                    this.allItems = res.data.data;\r\n                    this.itemData = res.data.data;\r\n                }\r\n            })\r\n        },\r\n        getImage(image){\r\n            return `http://localhost${image}`\r\n        },\r\n        handleClose(done) {\r\n            this.$confirm('确认关闭？')\r\n                .then(_ => {\r\n                    done();\r\n                })\r\n                .catch(_ => {});\r\n        },\r\n        handleChange(value) {\r\n            console.log(value);\r\n        },\r\n        buy(){\r\n            const order={\r\n                sellerId: this.detailData.item.sellerId,\r\n                itemId: this.detailData.item.itemId,\r\n                totalPrice: this.detailData.item.price,\r\n                orderStateString: 0,\r\n                complaintRecord: this.detailData.item.itemDescription\r\n            }\r\n            console.log(order);\r\n            axios.post('http://localhost/item/'+md5(this.pwd), order)\r\n                .then((res)=> {\r\n                    console.log(res);\r\n                    if(String(res.data.code) === '1'){\r\n                        this.$notify({\r\n                            title: '成功',\r\n                            message: res.data.msg,\r\n                            type: 'success'\r\n                        });\r\n                        this.load();\r\n                    }else{\r\n                        this.$notify.error({\r\n                            title: '错误',\r\n                            message: res.data.msg\r\n                        });\r\n                    }\r\n                })\r\n                .catch((error)=> {\r\n                    console.log(error);\r\n                    alert('输入格式错误');\r\n                });\r\n        },\r\n        detail(item){\r\n            this.detailData.item = item;\r\n        },\r\n        logout() {\r\n            var url = \"http://localhost/user/logout\";\r\n            fetch(url, { method: 'GET', credentials: 'include' })\r\n                .then(response => response.json())\r\n\r\n                .then(json_data => {\r\n                    // 处理响应数据\r\n                    console.log(json_data);\r\n                    if (json_data.code == \"1\") {\r\n                        window.sessionStorage.setItem('needRefresh', 'true');\r\n                        this.$router.push(\"/LoginView\");\r\n                    } else {\r\n                        alert(\"登出失败\");\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    // 处理错误\r\n                    console.error(error);\r\n                    alert(\"登出失败\");\r\n                });\r\n        },\r\n        logout_account() {\r\n            this.isLogoutModalVisible = true;\r\n        },\r\n        handleSearch(){\r\n            // 商品名筛选\r\n            this.itemData = this.allItems.filter(item=>{\r\n                if(this.search_name === \"\"){\r\n                    return item;\r\n                }else{\r\n                    if(Number(item.name.indexOf(this.search_name)) >= 0){\r\n                        return item;\r\n                    }\r\n                }\r\n            })\r\n            // 价格筛选\r\n            this.itemData = this.itemData.filter(item=>{\r\n                if(this.search_price1 === \"\" && this.search_price2 === \"\"){\r\n                    return item;\r\n                }else if(this.search_price1 !== \"\" && this.search_price2 !== \"\" &&\r\n                    item.price >= this.search_price1 && item.price <= this.search_price2){\r\n                    return item;\r\n                }else if(this.search_price1 === \"\" && item.price <= this.search_price2){\r\n                    return item;\r\n                }else if(this.search_price2 === \"\" && item.price >= this.search_price1){\r\n                    return item;\r\n                }\r\n            })\r\n        },\r\n        reset(){\r\n            this.search_name = \"\";\r\n            this.search_price1 = \"\";\r\n            this.search_price2 = \"\";\r\n            this.itemData = this.allItems;\r\n        }\r\n    }\r\n}\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}